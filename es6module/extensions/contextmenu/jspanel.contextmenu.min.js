"use strict";import{jsPanel}from"../../jspanel.js";jsPanel.contextmenu||(jsPanel.contextmenu={version:"1.0.0",date:"2018-03-16 14:30",defaults:{dragit:!1,resizeit:!1,header:!1,headerControls:"none"},cmOverflow(e){let t=e.cmEvent.clientX,n=e.cmEvent.clientY,s=e.offsetWidth,o=e.offsetHeight,l=window.innerWidth-(t+s),a=window.innerHeight-(n+o);l<0&&(e.style.left=t+(window.scrollX||window.pageXOffset)-s+"px"),a<0&&(e.style.top=n+(window.scrollY||window.pageYOffset)-o+"px")},create(e={},t="contextmenu"){e.paneltype="contextmenu";let n=e.target;if(!n)return!1;"string"==typeof n&&(n=document.querySelector(n)),n.addEventListener(t,t=>{t.preventDefault(),document.querySelectorAll(".jsPanel-contextmenu").forEach(e=>{e.close()});let s=(t.pageX||t.touches[0].pageX)+"px",o=(t.pageY||t.touches[0].pageY)+"px",l=e;e.config&&delete(l=Object.assign({},e.config,e)).config,l=Object.assign({},this.defaults,l,{position:!1,container:"body"}),jsPanel.create(l,e=>{jsPanel.setStyle(e,{position:"absolute",left:s,top:o});let l=n.closest(".jsPanel-modal");if(l)e.style.zIndex=l.style.zIndex;else{let t=n.closest(".jsPanel");t&&t.front(),e.style.zIndex=jsPanel.zi.next()}e.cmEvent=t,jsPanel.contextmenu.cmOverflow(e),e.addEventListener("mouseleave",()=>{e.close()},!1),e.addEventListener(jsPanel.evtStart,e=>{e.stopPropagation()},!1)})},!1)}},jsPanel.ajaxAlwaysCallbacks.push(function(e){e.classList.contains("jsPanel-contextmenu")&&jsPanel.contextmenu.cmOverflow(e)}),document.addEventListener(jsPanel.pointerdown,function(e){document.querySelectorAll(".jsPanel-contextmenu").forEach(function(t){e.target.closest(".jsPanel-contextmenu")||t.close()})},!1));